<nz-card class="card-header-custom card-header-custom1" [nzTitle]='"Dossier Summary"| translate' [nzExtra]="summaryEdit" >
    <div class="card-body-round" >
      <div class="content" style="width: 100%;">
        <div nz-row>  <p><b>{{"Status" | translate }}</b>:  &nbsp; </p><div *ngTemplateOutlet="templateStatus"></div></div>
       
        <p><b>{{"Name" | translate }}</b>: {{fileManagment?.name}}</p>
        <p><b>{{"Reference" | translate }}</b>: {{fileManagment?.file_number}}</p>
        <p><b>{{"Description" | translate }}</b>: {{fileManagment?.description}}</p>
      </div>
    </div>
  </nz-card>
  <ng-template #summaryEdit>
    <button nz-button  nzPlacement="bottomRight" class="mp-button-light" (click)="Edit()">
        {{'Edit'|translate}}
    </button>
  </ng-template>


<ng-template #templateStatus>
    
        <div nz-col [nzSpan]="10">
            <div class="tag {{getStatus(fileManagment?.status_id)?.system_code}}Tag">
                <div class="circle {{getStatus(fileManagment?.status_id)?.system_code}}Circle"></div>
                <span>{{ getStatus(fileManagment?.status_id)?.name }}</span>
            </div>
        </div>    
</ng-template>



<nz-modal id="file_edit" [(nzVisible)]="isVisibleEdit" [nzFooter]="null" [nzContent]="editTemplate" (nzOnCancel)="isVisibleEdit=false" style="border-radius:10px;width: 750px;">
    <ng-template #editTemplate  >
        <form  [formGroup]="form" >
            @if(onloading==true){ 
                <div class="loading-container">
                  <nz-spin nzSimple  nzTip="Loading..."  slot="header-actions-end"></nz-spin>
                </div> 
              }@else{
                @if(SubmitedSuccessfull==true){ 
                  <div nz-row  style="height: 100%;" >
                    <h4>{{'Submitted Successfully' | translate }}</h4>
                  </div>
                  <div nz-row  style="height: 100%; color: #807b7b !important" >
                    <p style="margin: 0px;">{{'Your print request has been successfully submitted! Your document is now in the queue and will be processed shortly.'|translate}}</p>
                    
                  </div>
                  <div nz-row  style="height: 100%;" >
                    <img nz-image width="435px" height="311px" style="padding:25px" nzSrc="../../../../assets/img/icons/svg/print_request_submitted.svg" alt=""/>    
                  </div>
                }
                @if(SubmitedSuccessfull==false){ 
                  <div nz-row  style="height: 100%;" >
                    <div nz-col [nzSpan]="24" class="edit-modal-header">
                          <h6>{{'Dossier Summary' | translate }}</h6>          
                    </div>                   
                  </div>
                  <nz-divider nzPlain nzVariant="solid"></nz-divider>
                  <div nz-row  style="height: 100%;"  >   
                    <div nz-col [nzSpan]="24" style="max-width: 100%" >      
                      <mat-form-field appearance="outline" style="width:100%">
                          <mat-label>{{'Name' | translate}}</mat-label>
                          <input matInput formControlName="name"
                            [ngClass]="{ 'is-invalid': submitted && f['file_number'].errors }" />
                          <div *ngIf="submitted && f['file_number'].errors" class="invalid-feedback">
                            <div *ngIf="f['file_number'].errors['required']">{{'Name' | translate}} {{'is required' |
                              translate}}</div>
                          </div>
                      </mat-form-field>
                          <mat-form-field appearance="outline" style="width:100%">
                              <mat-label>{{'Reference' | translate}}</mat-label>
                              <input matInput formControlName="file_number"
                                [ngClass]="{ 'is-invalid': submitted && f['file_number'].errors }" />
                              <div *ngIf="submitted && f['file_number'].errors" class="invalid-feedback">
                                <div *ngIf="f['file_number'].errors['required']">{{'Reference' | translate}} {{'is required' |
                                  translate}}</div>
                              </div>
                          </mat-form-field>
                          <mat-form-field appearance="outline"  style="width:100%">
                              <mat-label>{{'Status' | translate}}</mat-label>
                              <mat-select disableRipple formControlName="status_id">
                                <mat-option *ngFor="let status of this.arrCombos['STATUS']" [value]="status.id"> <div  class='color-dropbox color' style="--color: {{status.value}};">&nbsp;{{status.name | translate}} </div> 
                                </mat-option>
                              </mat-select>
                              <div *ngIf="submitted && f['status_id'].errors" class="invalid-feedback">
                                <div *ngIf="f['status_id'].errors['required']">{{'Status' | translate}} {{'is required' | translate}}
                                </div>
                              </div>
                          </mat-form-field>
      
                          <mat-form-field appearance="outline" id="description-filemanagment" style="width:100%">
                              <mat-label>{{'Description' | translate}}</mat-label>
                              <textarea   matInput type="text" rows="6" formControlName="description"
                                [ngClass]="{ 'is-invalid': submitted && f['description'].errors }"></textarea>
                              <div *ngIf="submitted && f['description'].errors" class="invalid-feedback">
                                <div *ngIf="f['description'].errors['required']">{{'Description' | translate}} {{'is required' |
                                  translate}}</div>
                              </div>
                          </mat-form-field>
                    </div>               
                  </div>
        
                      <div nz-row  style="height: 100%;">
                        <div nz-col [nzSpan]="12" style="max-width: 100%;" class="submit-buttons-center">
                          <button nz-button  class="mp-button-light" style="width: 95%;margin-right: 15px;" (click)="isVisibleEdit=false">
                            {{'Cancel'|translate}}
                          </button>
                        </div>
                        <div nz-col [nzSpan]="12" style="max-width: 80%;" class="submit-buttons-center">
                          <button  nz-button nzType="primary" nzDanger class="mp-button-primary" style="width: 100%;" (click)="onFileManagmentChange()">
                            {{'Save'|translate}}
                          </button>
                        </div>                   
                  </div>               
        
                }
              }

        </form>

        
    </ng-template>
</nz-modal>
